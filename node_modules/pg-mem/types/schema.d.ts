import { ISchema, DataType, IType, Schema, QueryResult, nil, FunctionDefinition, IEquivalentType, QueryInterceptor, ISubscription } from './interfaces';
import { _IDb, _ISelection, _ISchema, _Transaction, _ITable, _SelectExplanation, _FunctionDefinition, _IType, _IRelation, QueryObjOpts, _ISequence, RegClass, Reg, TypeQuery, BeingCreated } from './interfaces-private';
import { CreateTableStatement, SelectStatement, CreateIndexStatement, AlterTableStatement, CreateExtensionStatement, CreateSequenceStatement, AlterSequenceStatement, QName, DropIndexStatement, DropTableStatement, DropSequenceStatement, TruncateTableStatement, CreateSequenceOptions, DataTypeDef, CreateViewStatement, CreateMaterializedViewStatement } from 'pgsql-ast-parser';
import { MemoryTable } from './table';
import { IMigrate } from './migrate/migrate-interfaces';
export declare class DbSchema implements _ISchema, ISchema {
    readonly name: string;
    readonly db: _IDb;
    readonly dualTable: _ITable;
    private relsByNameCas;
    private relsByCls;
    private relsByTyp;
    private tempBindings;
    private _tables;
    private lastSelect?;
    private fns;
    private installedExtensions;
    private readonly;
    private interceptors;
    constructor(name: string, db: _IDb);
    setReadonly(): this;
    none(query: string): void;
    one(query: string): any;
    many(query: string): any[];
    query(text: string): QueryResult;
    private parse;
    queries(query: string): Iterable<QueryResult>;
    private _execOne;
    private do;
    private createFunction;
    private executeShow;
    private executeWith;
    private buildWith;
    private prepareWithable;
    private executeWithable;
    registerEnum(name: string, values: string[]): void;
    private checkExistence;
    executeCreateExtension(p: CreateExtensionStatement): void;
    executeCreateView(t: _Transaction, p: CreateViewStatement): QueryResult;
    executeCreateMaterializedView(t: _Transaction, p: CreateMaterializedViewStatement): QueryResult;
    private locOf;
    private simpleTypes;
    private sizeableTypes;
    parseType(native: string): _IType;
    getOwnType(t: DataTypeDef): _IType | null;
    getTypePub(t: DataType | IType): _IType;
    getType(t: TypeQuery): _IType;
    getObject(p: QName): _IRelation;
    getObject(p: QName, opts: BeingCreated): _IRelation;
    getObject(p: QName, opts?: QueryObjOpts): _IRelation | null;
    getOwnObject(name: string): _IRelation | null;
    getObjectByRegOrName(reg: RegClass): _IRelation;
    getObjectByRegOrName(reg: RegClass, opts?: QueryObjOpts): _IRelation | null;
    getObjectByRegClassId(reg: number): _IRelation;
    getObjectByRegClassId(reg: number, opts?: QueryObjOpts): _IRelation | null;
    getOwnObjectByRegClassId(reg: number): _IRelation | null;
    executeAlterRequest(t: _Transaction, p: AlterTableStatement): QueryResult;
    executeCreateIndex(t: _Transaction, p: CreateIndexStatement): QueryResult;
    private simple;
    executeCreateSequence(t: _Transaction, p: CreateSequenceStatement): QueryResult;
    createSequence(t: _Transaction, opts: CreateSequenceOptions | nil, _name: QName | nil): _ISequence;
    executeAlterSequence(t: _Transaction, p: AlterSequenceStatement): QueryResult;
    executeDropIndex(t: _Transaction, p: DropIndexStatement): QueryResult;
    executeDropTable(t: _Transaction, p: DropTableStatement): QueryResult;
    executeDropSequence(t: _Transaction, p: DropSequenceStatement): QueryResult;
    executeCreateTable(t: _Transaction, p: CreateTableStatement): QueryResult;
    explainLastSelect(): _SelectExplanation | undefined;
    explainSelect(sql: string): _SelectExplanation;
    private executeDelete;
    executeTruncateTable(t: _Transaction, p: TruncateTableStatement): QueryResult;
    private buildUnion;
    buildSelect(p: SelectStatement): _ISelection;
    private executeUpdate;
    private createSetter;
    private executeInsert;
    getTable(name: string): _ITable;
    getTable(name: string, nullIfNotFound?: boolean): _ITable | null;
    declareTable(table: Schema, noSchemaChange?: boolean): MemoryTable;
    registerEquivalentType(type: IEquivalentType): IType;
    _registerTypeSizeable(name: string, ctor: (sz?: number) => _IType): this;
    _registerType(type: _IType): this;
    _reg_register(rel: _IRelation): Reg;
    _reg_unregister(rel: _IRelation): void;
    _reg_rename(rel: _IRelation, oldName: string, newName: string): void;
    tablesCount(t: _Transaction): number;
    listTables(): Iterable<_ITable>;
    registerFunction(fn: FunctionDefinition, replace?: boolean): this;
    getFunctions(name: string | QName, arrity: number, forceOwn?: boolean): Iterable<_FunctionDefinition>;
    migrate(config?: IMigrate.MigrationParams): Promise<void>;
    interceptQueries(intercept: QueryInterceptor): ISubscription;
}
//# sourceMappingURL=schema.d.ts.map